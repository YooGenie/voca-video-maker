# EngReelGen Go 코딩 스타일 가이드

이 문서는 **EngReelGen** 프로젝트의 일관성 있고 고품질인 Go 코드 작성을 위한 스타일 가이드입니다. 모든 코드는 이 가이드를 따라야 합니다.

## 1. 기본 원칙

- **가독성**: 코드는 작성하는 것보다 읽는 시간이 훨씬 깁니다. 항상 명확하고 읽기 쉽게 작성합니다.
- **단순성**: 불필요한 복잡성을 피하고 Go의 관용적인(idiomatic) 방식을 따릅니다.
- **일관성**: 프로젝트 전체에서 일관된 스타일과 패턴을 유지합니다.

## 2. 포매팅 (Formatting)

모든 Go 코드는 `gofmt` 도구를 사용하여 포매팅해야 합니다. 이는 Go 커뮤니티의 표준이며, 코드 형식에 대한 모든 논쟁을 끝냅니다.

- 파일을 저장할 때마다 IDE에서 자동으로 `gofmt`가 실행되도록 설정하는 것을 강력히 권장합니다.
- 또는, 커밋하기 전에 `gofmt -w .` 명령을 실행하여 프로젝트 전체를 포매팅합니다.

## 3. 명명 규칙 (Naming Convention)

프로젝트의 모든 이름은 다음 규칙을 따릅니다.

### 3.1. 디렉토리 및 파일명 (Directories and Filenames)

- **디렉토리 (패키지명)**: 소문자, 단어는 하이픈(`-`)으로 구분하는 `kebab-case`를 사용합니다. Go 패키지 선언 시에는 하이픈을 제외하고 붙여 씁니다. (예: 디렉토리 `short-sentence` -> `package shortsentence`)
- **Go 파일**: 디렉토리와 동일하게 `kebab-case`를 사용합니다.
  - 예시: `video-creation-service.go`

### 3.2. Go 코드

- **변수명/함수명**: `camelCase` (예: `generateVideo`)
- **Export되는 함수/메서드/구조체/인터페이스**: `PascalCase` (예: `GenerateVideo`, `VideoRequest`)
- **상수**: `PascalCase` 또는 `UPPER_SNAKE_CASE` (예: `DefaultTimeout`, `MAX_RETRIES`)
- **인터페이스**: 하나의 메서드만 가질 경우 `-er` 접미사를 사용합니다. (예: `Reader`)

## 4. 주석 (Comments)

- **문서 주석 (Godoc)**:
    - 모든 Export되는 식별자(변수, 함수, 타입)에는 기능을 설명하는 문서 주석을 작성해야 합니다.
    - 주석은 식별자 이름으로 시작하는 완전한 문장으로 작성합니다.
    - 예: `// GenerateVideo creates a video based on the provided request.`
- **일반 주석**:
    - 복잡한 로직이나, 코드가 "무엇을" 하는지가 아닌 "왜" 그렇게 해야 하는지를 설명할 때 사용합니다.
    - 불필요하거나 명백한 주석은 피합니다.

## 5. 에러 처리 (Error Handling)

- 에러는 Go의 표준 방식에 따라 명시적으로 처리해야 합니다.
- 함수가 에러를 반환할 수 있다면, 마지막 반환 값은 `error` 타입이어야 합니다.
- 에러를 받았을 때는 즉시 확인합니다: `if err != nil { ... }`
- 에러를 무시하지 마십시오. 처리할 수 없다면, 컨텍스트를 추가하여 상위 호출자에게 반환합니다. (예: `fmt.Errorf("creating video clip: %w", err)`)
- `panic`은 정말로 복구 불가능한 예외적인 상황에서만 사용해야 합니다.

### 5.1. `log.Fatalf` 사용 정책

이 프로젝트는 **CLI 애플리케이션**이므로, 다음 상황에서 `log.Fatalf` 사용이 **허용**됩니다:

- **필수 의존성 초기화 실패**: 데이터베이스 연결, 설정 파일 로딩 등
- **복구 불가능한 에러**: 필수 리소스 누락, 시스템 에러 등
- **서비스 레이어 에러**: 영상 생성 중 발생하는 치명적 에러

> **참고**: Web API로 전환 시에는 `log.Fatalf` 대신 `error` 반환 방식으로 변경해야 합니다.

## 6. 패키지 및 프로젝트 구조

프로젝트 구조는 `GEMINI.md` 문서에 정의된 규칙을 엄격히 준수합니다. 각 패키지의 역할과 책임을 명확히 이해하고 코드를 작성해야 합니다.

- **`main`**: 애플리케이션 진입점. 최소한의 로직만 포함.
- **`factory`**: 비디오 타입에 따라 적절한 서비스 구현체를 반환.
- **`service`**: 핵심 비즈니스 로직.
- **`repository`**: 데이터베이스 상호작용.
- **`dto`**, **`entity`**: 데이터 구조 정의.

## 7. 린팅 (Linting)

코드 품질을 자동으로 검사하기 위해 `golangci-lint` 사용을 권장합니다.

- `golangci-lint run` 명령을 통해 잠재적인 버그, 스타일 문제, 성능 이슈 등을 사전에 발견할 수 있습니다.
- 프로젝트 루트에 `.golangci.yml` 설정 파일을 추가하여 규칙을 관리할 수 있습니다.

## 8. 데이터베이스 스키마 관리 (DDL)

테이블 구조 변경 시 반드시 DDL 파일에 기록해야 합니다.

- **DDL 파일 경로**: `/Users/sunny/go/src/auto-video-service/DDL.sql`
- **기록 내용**: 테이블 생성, 컬럼 추가/수정/삭제, 인덱스 변경 등 모든 스키마 변경사항
- **형식**: 날짜 주석과 함께 변경 사항을 기록
  ```sql
  -- [YYYY-MM-DD] 변경 설명
  ALTER TABLE table_name ADD COLUMN column_name VARCHAR(20);
  ```
# 🎬 EngReelGen: 영어 학습용 숏폼 자동 생성 서비스 가이드

이 문서는 AI 어시스턴트(Gemini Code Assist)가 **EngReelGen** 프로젝트를 이해하고, 개발 작업을 지원하기 위한 핵심 컨텍스트와 규칙을 정의합니다.

## 1. 프로젝트 개요 및 기술 스택

| 구분                  | 내용                                                                                                                             |
| :-------------------- | :------------------------------------------------------------------------------------------------------------------------------- |
| **서비스 목적**       | 입력된 날짜와 비디오 유형에 따라 영어 학습용 숏폼(Reels/Shorts) 영상을 Go 언어로 자동 생성합니다.                                |
| **애플리케이션 형태** | Go 언어로 작성된 **명령줄(CLI) 독립형 애플리케이션**이어야 합니다.                                                               |
| **최종 산출물**       | 이미지, 영어 오디오, 한국어 오디오를 조합하여 만든 단일 **`.mp4`** 파일.                                                         |
| **주요 기술**         | **주 언어:** Go (Golang) / **비디오 처리:** FFmpeg 또는 Go 기반 영상 라이브러리 / **TTS:** Google, AWS, 또는 Azure TTS API 사용. |

## 2. 프로젝트 구조 및 패키지 규칙

프로젝트는 다음 패키지 구조를 **엄격히 준수**하며, 모든 비디오 생성 로직은 **Factory 패턴**을 통해 선택되어야 합니다.

- **`main/`**: 애플리케이션 진입점 (`main.go`). CLI 플래그 파싱 및 Factory 호출 담당.
- **`config/`**: DB 연결 설정, 환경 변수 로딩 로직.
- **`dto/`**: 데이터 전송 객체 (Content DTO, Clip DTO 등).
- **`entity/`**: 데이터베이스 엔터티 정의.
- **`factory/`**: **Factory 패턴** 구현. `-type` 플래그에 따라 적절한 서비스(`service/`) 구현체를 반환하는 로직 포함.
- **`repository/`**: DB 조회/저장 로직. 날짜 기반 콘텐츠 조회 기능 구현이 핵심.
- **`service/`**: 비즈니스 로직 포함.
  - `common/`: **공통 로직** (이미지 생성, TTS 호출, FFmpeg 클립 조립/병합 등) 구현.
  - `word/`, `idiom/`, `long/`, `intro/`: 각 비디오 유형별 **전용 비디오 생성 서비스** 구현.

## 3. 핵심 기능 요구사항 상세

### 3.1. 명령줄 인터페이스 (CLI)

| 플래그      | 설명                        | 필수 여부       | 형식                                  |
| :---------- | :-------------------------- | :-------------- | :------------------------------------ |
| **`-type`** | 생성할 비디오 종류 지정.    | 필수 (Required) | `W`, `I`, `L`, `START`                |
| **`-date`** | 비디오 생성 기준 날짜 지정. | 선택 (Optional) | `YYYYMMDD` (미입력 시 오늘 날짜 사용) |

### 3.2. 비디오 유형 및 로직 (1. 및 2. 요구사항)

| Type      | 설명                                | 로직 구분                                                         |
| :-------- | :---------------------------------- | :---------------------------------------------------------------- |
| **W**     | 오늘의 영어 단어 (Word of the Day)  | `service/word/`에서 구현. 날짜별로 다른 단어 콘텐츠 DB 조회.      |
| **I**     | 오늘의 영어 숙어 (Idiom of the Day) | `service/idiom/`에서 구현. 날짜별로 다른 숙어 콘텐츠 DB 조회.     |
| **L**     | 장문 영어 단어 (Long Word)          | `service/long/`에서 구현. 날짜별로 다른 장문 단어 콘텐츠 DB 조회. |
| **START** | 시작 멘트 전용 비디오 (인트로)      | `service/intro/`에서 구현.                                        |

### 3.3. 비디오 애셋 생성 및 조립 (3., 4., 5. 요구사항)

1.  **이미지 생성:**
    - **해상도:** **1080x1920** (세로형 숏폼).
    - 템플릿 기반으로 텍스트(단어, 의미, 예문)를 오버레이하여 생성.
    - 생성된 파일은 임시 디렉토리에 저장.
2.  **오디오 생성 (TTS):**
    - **영어 오디오:** 원어민 발음으로 단어/숙어/예문을 읽어야 함.
    - **한국어 오디오:** 의미나 설명을 한국어로 읽어야 함.
    - 각 텍스트별로 별도의 오디오 파일 생성 후 임시 파일로 저장.
3.  **클립 조립:**
    - `생성된 이미지 1장 + 영어 오디오 + 한국어 오디오`를 조합하여 **1개의 클립(video segment)** 생성.
    - 클립 길이는 오디오 길이에 따라 **자동 조절**되어야 함.

### 3.4. 최종 출력 및 정리 (6. 및 7. 요구사항)

- **최종 파일 이름:** `YYMMDD_<type>.mp4` 형식으로 출력해야 합니다.
- **임시 파일 정리:** 최종 비디오 출력 후, 생성 과정에서 사용된 **모든 임시 파일** (이미지, 오디오, 중간 클립)은 **반드시 삭제**되어야 합니다. 이 로직은 각 서비스 구현체(`GenerateVideo` 후)의 `CleanUp()` 메서드를 통해 처리되어야 합니다.
답변은 항상 한국어로 한다